const e="https://webmob-ui-22-spotlified.herokuapp.com";async function t(e){const t=await fetch(e);return await t.json()}async function n(){return await t(`${e}/api/artists`)}async function r(n){return await t(`${e}/api/artists/${n}/songs`)}async function s(n){return await t(`${e}/api/songs/search/${encodeURIComponent(n)}`)}const i=document.querySelector("#artist-list-item-template"),o=document.querySelector(".artist-list");var a=async()=>{o.replaceChildren();(await n()).forEach((e=>{const t=i.content.cloneNode(!0);t.querySelector("a").href="#artists-"+e.id,t.querySelector(".artist-list-item-title").innerHTML=e.name,t.querySelector("img").src=e.image_url,o.append(t)}))};function c(e){e=parseInt(e,10);let t=Math.floor(e/3600),n=Math.floor((e-3600*t)/60),r=e-3600*t-60*n;return n<10&&(n="0"+n),r<10&&(r="0"+r),n+":"+r}const l=document.querySelector("#audio-player"),d=document.querySelector("#player-thumbnail-image"),u=document.querySelector("#player-infos-song-title"),m=document.querySelector("#player-infos-artist-name"),h=document.querySelector("#player-control-previous"),y=document.querySelector("#player-control-play"),p=document.querySelector("#player-control-play .material-icons"),g=document.querySelector("#player-control-next"),v=document.querySelector("#player-time-current"),S=document.querySelector("#player-time-duration"),f=document.querySelector("#player-progress-bar"),w=document.querySelector("#logo");let q=[],L=null;const E=(e,t)=>{L=e,t&&(q=t),l.src=e.audio_url,l.play(),u.innerHTML=e.title,m.innerHTML=e.artist.name,d.src=e.artist.image_url},_=()=>{l.paused?(p.innerHTML="play_arrow",w.classList.remove("animated")):(p.innerHTML="pause",w.classList.add("animated"))};y.addEventListener("click",(()=>{l.paused?l.play():l.pause()})),h.addEventListener("click",(()=>{const e=q.indexOf(L)-1;E(e>=0?q[e]:q[q.length-1])})),g.addEventListener("click",(()=>{const e=q.indexOf(L)+1;e<q.length?E(q[e]):E(q[0])})),f.addEventListener("change",(e=>{l.currentTime=e.currentTarget.value})),l.addEventListener("durationchange",(()=>{f.max=l.duration,S.innerText=c(l.duration)})),l.addEventListener("timeupdate",(()=>{f.value=l.currentTime,v.innerText=c(l.currentTime)})),l.addEventListener("play",_),l.addEventListener("pause",_);var $=E;class k{constructor(e={}){this.options={name:e.name||"default",listen:e.listen||!0,trigger:e.trigger||!0,eventName:e.eventName||"jsonstorage"},this._reloadKeys(),this.options.listen&&window.addEventListener("storage",(e=>{e.key.startsWith(`${this.options.name}_`)&&(this._reloadKeys(),this.options.trigger&&window.dispatchEvent(new Event(this.options.eventName)))}))}_reloadKeys(){this.storageKeys=Object.keys(localStorage).filter((e=>e.startsWith(`${this.options.name}_`))).reduce(((e,t)=>e.set(t.substring(`${this.options.name}_`.length),1)),new Map)}[Symbol.iterator](){return this.entries()}keys(){return this.storageKeys.keys()}key(e){let t=[...this.keys()];return e<0||e>=t.length?null:t[e]}*values(){for(let e of this.keys())yield this.getItem(e)}*entries(){for(let e of this.keys())yield[e,this.getItem(e)]}forEach(e){for(let t of this)e(t[1],t[0])}toArray(){return[...this.entries()]}toObject(){let e={};for(let t of this)e[t[0]]=t[1];return e}toJSON(){return JSON.stringify(this.toObject())}get length(){return this.storageKeys.size}get size(){return this.length}setItem(e,t){localStorage.setItem(`${this.options.name}_${e}`,JSON.stringify(t)),this.storageKeys.set(e.toString(),1),this.options.trigger&&window.dispatchEvent(new Event(this.options.eventName))}_genKey(){return"uid_"+Math.random().toString(36).substring(2,10)}addItem(e){let t=this._genKey();for(;this.storageKeys.has(t.toString());)t=this._genKey();return this.setItem(t,e),t}getItem(e){let t=localStorage.getItem(`${this.options.name}_${e}`);return null==t?null:JSON.parse(t)}removeItem(e){localStorage.removeItem(`${this.options.name}_${e}`),this.storageKeys.delete(e.toString()),this.options.trigger&&window.dispatchEvent(new Event(this.options.eventName))}clear(){for(let e of this.keys())localStorage.removeItem(`${this.options.name}_${e}`);this.storageKeys.clear(),this.options.trigger&&window.dispatchEvent(new Event(this.options.eventName))}}const I=new k({name:"favorites",eventName:"favorites_updated"}),b=e=>{T(e)?I.removeItem(e.id):I.setItem(e.id,e)},T=e=>I.getItem(e.id),K=document.querySelector("#list-item-template"),N=document.querySelector(".list"),x=document.querySelector("#list-section h4"),M=(e,t)=>{T(t)?e.innerText="playlist_remove":e.innerText="playlist_add"},O=e=>{N.replaceChildren(),e.forEach((t=>{const n=K.content.cloneNode(!0);n.querySelector(".list-item-title").innerHTML=t.title,n.querySelector(".play-button").addEventListener("click",(()=>{$(t,e),window.location.hash="#player"}));const r=n.querySelector(".favorite-button .material-icons");n.querySelector(".favorite-button").addEventListener("click",(()=>{b(t),M(r,t)})),M(r,t),N.append(n)}))},C=async e=>{const t=await r(e);x.textContent=`Artistes > ${t[0].artist.name}`,O(t)},H=async e=>{const t=await s(e);x.textContent=`RÃ©sultats pour "${decodeURIComponent(e)}"`,O(t)},j=()=>{const e=I.toArray().map((e=>e[1]));x.innerText="Favoris",O(e)},J=document.querySelector("#search-trigger"),R=document.querySelector("#search-input");J.addEventListener("click",(()=>{R.classList.add("active"),R.focus()})),R.addEventListener("blur",(()=>{R.classList.remove("active"),R.value=""})),R.addEventListener("change",(()=>{window.location.hash=`#search-${encodeURIComponent(R.value)}`}));const A=e=>{document.querySelector("section.active")?.classList.remove("active"),document.querySelector(`${e}-section`)?.classList.add("active")},U=e=>{""==e&&(e="#home");const t=e.split("-");switch((e=>{document.querySelector("nav a.active")?.classList.remove("active"),document.querySelector(`nav a[href="${e}"]`)?.classList.add("active")})(t[0]),A(t[0]),t[0]){case"#artists":t[1]?(A("#list"),C(t[1])):a();break;case"#search":A("#list"),H(t[1]);break;case"#favorites":A("#list"),j()}};window.addEventListener("favorites_updated",(()=>{"#favorites"==window.location.hash&&j()})),window.addEventListener("hashchange",(()=>U(window.location.hash))),U(window.location.hash);
//# sourceMappingURL=index.5d0e2326.js.map
